<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>TrafficHuancayo | Rutas Inteligentes</title>

  <link rel="stylesheet" href="styles1.css" />
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700;800&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>
  
  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />
  <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>
  
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

  <div id="toast-container" class="toast-container"></div>

  <nav class="navbar glass">
    <div class="container nav-inner">
      <div class="brand">
        <div class="logo-icon">üö¶</div>
        <div class="brand-text">
          <h1>TrafficHuancayo</h1>
          <span>AI Navigation</span>
        </div>
      </div>
      <div class="nav-links">
        <a href="#mapa" class="active">Mapa</a>
        <a href="#estadisticas">Datos</a>
        <button class="btn-login">Acceso</button>
      </div>
    </div>
  </nav>

  <main>
    <header class="hero-section">
      <div class="container">
        <div class="hero-text">
          <div class="badge">‚ú® Algoritmo de Optimizaci√≥n v2.0</div>
          <h2>Mu√©vete inteligente en Huancayo</h2>
          <p>No te decimos cu√°nto te vas a demorar. <b>Te decimos por d√≥nde ir</b> para ahorrar tiempo.</p>
          <div class="hero-stats">
            <div class="h-stat">
              <strong id="liveReports">--</strong><span>Puntos Monitoreados</span>
            </div>
            <div class="h-stat success">
              <strong id="savingsText">Eficiencia</strong><span>Prioridad</span>
            </div>
          </div>
        </div>
      </div>
    </header>

    <section id="mapa" class="section-map">
      <div class="container dashboard-grid">
        
        <aside class="sidebar glass">
          <div class="sidebar-tabs">
            <button class="tab-btn active" data-tab="info">Info</button>
            <button class="tab-btn" data-tab="route">üó∫Ô∏è Ruta IA</button>
            <button class="tab-btn" data-tab="report">üì¢ Reportar</button>
          </div>

          <div id="tab-info" class="tab-content active">
            <div class="sidebar-block">
              <h4>‚ö†Ô∏è Estado de las V√≠as</h4>
              <ul id="alertList" class="alert-list">
                <li>Analizando tr√°fico...</li>
              </ul>
            </div>
          </div>

          <div id="tab-route" class="tab-content">
            <div class="route-panel">
              <h4>Planificador Inteligente</h4>
              <p class="small-text">Click derecho en el mapa para marcar <b>Inicio</b> y <b>Fin</b>.</p>
              
              <div class="route-inputs">
                <div class="input-row">
                  <span class="dot-start"></span>
                  <input id="route-start" placeholder="Punto de partida..." readonly>
                </div>
                <div class="input-row">
                  <span class="dot-end"></span>
                  <input id="route-end" placeholder="Destino..." readonly>
                </div>
              </div>

              <div id="route-options-container" class="route-options hidden">
                  </div>

              <div id="route-stats" class="route-stats hidden">
                </div>
              
              <button id="btnClearRoute" class="btn btn-outline btn-block hidden" style="margin-top:10px;">Nueva Consulta</button>
            </div>
          </div>

          <div id="tab-report" class="tab-content">
            <form id="reportForm" class="form-compact">
               <h4>Nuevo Reporte</h4>
               <div class="radio-group-compact">
                 <label><input type="radio" name="tipo" value="congestion" checked> üê¢ Tr√°fico</label>
                 <label><input type="radio" name="tipo" value="accidente"> üí• Accidente</label>
               </div>
               <input type="text" id="r_ubicacion" placeholder="Ubicaci√≥n (ej. Calle Real)" required>
               <input type="text" id="r_desc" placeholder="Detalle (opcional)">
               <button type="submit" class="btn btn-primary btn-block">Enviar Reporte</button>
            </form>
          </div>
        </aside>

        <div class="map-wrapper glass">
          <div class="map-header">
            <h3>Mapa en Tiempo Real</h3>
            <div class="map-tools">
              <button id="btnHeat" class="tool-btn active" title="Alternar Calor">üî•</button>
              <button id="btnLocate" class="tool-btn" title="Centrar Mapa">üìç</button>
            </div>
          </div>
          <div id="map"></div>
        </div>

      </div>
    </section>

    <section id="estadisticas" class="section-stats">
      <div class="container">
        <h2 class="section-title">An√°lisis de Movilidad</h2>
        <div class="charts-grid">
          <div class="chart-box glass">
            <h4>Distribuci√≥n de Incidentes</h4>
            <div style="position: relative; height:200px; width:100%">
              <canvas id="chartType"></canvas>
            </div>
          </div>
          <div class="chart-box glass">
            <h4>Congesti√≥n: Top Avenidas</h4>
            <div id="avenueBars" class="avenue-chart"></div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container">
      <p>&copy; 2025 TrafficHuancayo AI.</p>
    </div>
  </footer>
  <!-- Firebase Core -->

  <script type="module" src="script1.js"></script>
</body>
</html>